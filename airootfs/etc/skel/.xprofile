#!/bin/sh

if [[ ! -z $isvm ]]; then
    mon=$(xrandr -q | grep -w connected | awk '{print $1}')
    xrandr --output $mon --auto
    res=$(xrandr | sed "s/x/\ /g" | grep \* | awk '{print $1}')
    scale=$(bc -l <<< "2560/$res")
    xrandr --output $mon --scale $scale
fi

xrdb ~/.config/Xresources
pOS-setbg &			# set the background
# Below is disabled in usb installer for performance issues on older backends
# isvm=$( hwinfo | grep Virtual )
# if [[ -z $isvm ]]; then
#     picom --experimental-backends --backend glx &		# picom for transparency and rounded corners
# else
#     picom &
# fi
# pOS-conky &
dunst &			# dunst for notifications
pOS-remaps &		# run the remaps script, switching caps/esc and more; check it for more info
xset r rate 250 40 &	# Speed xrate up
[[ -f /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 ]] && /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &
unclutter &		# Remove mouse when idle
dex -a & # Start xdg autostart
(sleep 5 && notify-send "Animations and picom is disabled in liveiso, Caps+T to toggle") &
